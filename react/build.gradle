plugins {
    // https://github.com/srs/gradle-node-plugin/blob/master/docs/node.md
    id "com.moowork.node" version "1.1.1"
}

node {
    version = '6.10.3'
    npmVersion = '4.6.1'
    download = true
}

task webpack(type: NodeTask, dependsOn: 'yarn_install') {
    script = file('node_modules/.bin/webpack')
    args = ['--progress', '-p', '--env.NODE_ENV', 'production', '--env.API_ROOT', '/a']
}

task jest(type: NodeTask, dependsOn: 'yarn_install') {
    script = project.file('node_modules/.bin/jest')
}

test.dependsOn(jest)

build.dependsOn(webpack)

