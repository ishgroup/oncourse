plugins {
    id "com.moowork.node" version "1.1.1"
}

node {
    version = '6.10.3'
    npmVersion = '4.6.1'
    download = true
}

// https://github.com/srs/gradle-node-plugin/blob/master/docs/node.md

npm_install.dependsOn(yarn_install)

task webpack(type: NodeTask, dependsOn: 'npmInstall') {
    script = project.file('node_modules/.bin/webpack')
    options = ['-p', '--env.NODE_ENV production']
}

task jest(type: NodeTask, dependsOn: 'npmInstall') {
    script = project.file('node_modules/.bin/jest')
}
test.dependsOn(jest)

//    "packages:refresh": "npm prune && npm install",
//    "build:prod": "npm run clean && webpack -p --env.NODE_ENV production --env.API_ROOT https://ish.com.au",
//    "build:prod:watch": "webpack --watch -p --env.NODE_ENV production --env.API_ROOT https://ish.com.au",
//    "build:dev": "npm run clean && webpack",
//    "build:dev:watch": "webpack --debug --watch --env.SOURCE_MAP eval-source-map",
//    "test": "karma start ./karma.conf.js",
//    "test:watch": "karma start ./karma.conf.js --auto-watch --no-single-run",
//    "jest": "jest",
//    "start": "webpack-dev-server --env.SOURCE_MAP eval-source-map"

