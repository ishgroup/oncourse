<html t:type="ui/internal/pagestructure" bodyId="literal:PaymentPage"
	  bodyClass="literal:internal-page"
	  xmlns:t="http://tapestry.apache.org/schema/tapestry_5_1_0.xsd">

<t:if test="paymentProgress">
	<meta http-equiv="refresh" content="3"/>
</t:if>
<div id="checkout">

	<t:delegate to="block:errors"/>
	<t:if test="editPayment">
		<t:delegate to="block:paymentEditor"/>
	</t:if>
	<t:if test="paymentResult">
		<t:delegate to="block:paymentResult"/>
	</t:if>
	<t:if test="paymentProgress">
		<t:delegate to="block:paymentProgress"/>
	</t:if>
</div>

<t:block t:id="paymentEditor">
	<span t:type="checkout/payment/paymenteditor" delegate="purchaseController.paymentEditorDelegate"/>
</t:block>
<t:block t:id="paymentProgress">
	<span t:type="checkout/payment/paymentProgress" delegate="purchaseController.paymentEditorDelegate"/>
</t:block>
<t:block t:id="paymentResult">
	<span t:type="checkout/payment/paymentresult" delegate="purchaseController.paymentEditorDelegate"/>
</t:block>
<t:block t:id="errors">
    <t:if test="expired">
        <div class="error">
            <p>${message:message-sessionExpired}</p>
            <script type="text/javascript">
                setTimeout("window.location.href='${coursesLink}'", 10000);
            </script>
        </div>
    </t:if>

    <t:if test="purchaseController">
        <span t:type="checkout/errors" errors="purchaseController.errors" warnings="purchaseController.warnings"/>
        <t:if test="purchaseController.illegalModel">
            <script type="text/javascript">
                setTimeout("window.location.href='${coursesLink}'", 10000);
            </script>
        </t:if>
    </t:if>
</t:block>

<link href="${asset:context:css/_checkout.css}" media="screen, print" rel="stylesheet"/>
<script type="text/javascript" src="${asset:context:js/jquery.blockUI.js}"/>
<script type="text/javascript" src="${asset:context:js/_common.js}"/>
<script type="text/javascript" src="${asset:context:js/_checkout.js}"/>

</html>