apply plugin: 'war'
apply plugin: 'compass'

dependencies {
    providedCompile 'javax.servlet:servlet-api:3.0'

	compile project(':common:common-services')
	compile project(':common:common-model')
	compile project(':common:common-ui')
	compile 'org.apache.tapestry:tapestry-upload:5.2.6'

	// The odd next line is to work around gradle pulling in the wrong configuration
	// http://forums.gradle.org/gradle/topics/transitive_libraries_not_included_through_project_dependency
	testCompile project(path: ':common:common-test', configuration: 'testFixtures')

	testCompile "org.powermock:powermock-module-junit4:1.6.2"
	testCompile "org.powermock:powermock-api-mockito:1.6.2"
}


war {
	archiveName = 'enrol.war'
	manifest {
		from sharedManifest
	}

    from 'build/resource-assemble'
    from 'build/resource'
    from ('src/main/static') {
        exclude 'js'
        exclude 'src'
    }
}

processResources.inputs.files gzipJs
processResources.inputs.files gzipCss

clean.dependsOn cleanMinifyJs
clean.dependsOn cleanCompileSass
