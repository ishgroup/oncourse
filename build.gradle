apply plugin: 'idea'

buildscript {
    ext {
        cayenneVersion = '4.1'
    }

    repositories {
        maven {
            url 'https://repo.ish.com.au/content/groups/public'
        }
    }

    dependencies {
        classpath "org.apache.cayenne.plugins:cayenne-gradle-plugin:$cayenneVersion"
    }
}

subprojects {
    apply plugin: 'java'
    apply plugin: 'groovy'

    apply plugin: 'java-library'
    apply plugin: 'maven-publish'
    

    sourceCompatibility = 11
    repositories {
        maven {
            url 'https://repo.ish.com.au/content/repositories/ish-snapshots'
        }
        
    }
    
    dependencies {
        implementation "ish.oncourse.angel:server:99-SNAPSHOT"
    }

    group = 'ish.oncourse.commercial.plugin'
    version = project.hasProperty('releaseVersion') && project.releaseVersion ? project.releaseVersion : "99-SNAPSHOT"

    publishing {
        repositories {
            maven {
                name = "ish"
                def repo = version.endsWith('SNAPSHOT') ? 'ish-snapshots' : 'ish-releases'
                url = "https://repo.ish.com.au/content/repositories/${repo}"
                credentials {
                    username nexusUsername
                    password nexusPassword
                }
            }
        }
    }
    
}
