<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<t:container xmlns:t="http://tapestry.apache.org/schema/tapestry_5_1_0.xsd" xmlns:p="tapestry:parameter">
	<div class="class_details">
		<ul class="class_timetable" title="View calendar">
			<t:if t:test="courseClass.hasSessions">
				<li class="class_date">
					<a class="timeline" rel="session" href="/Timeline/sessions?ids=${courseClass.id}" timezone="10"><span t:type="ui/DateRangeDisplay" date1="courseClass.startDate" date2="courseClass.endDate" timezone="courseClass.classTimeZone"/></a>
				</li>
				<li class="class_time">
					<a class="timeline" rel="session" href="/Timeline/sessions?ids=${courseClass.id}" timezone="10">
           				<span style="text-transform: lowercase;">
           					 <span t:type="ui/willowtext" escapingHTML="false" value="courseClass.firstSession.startTimestamp" dateformat="~#m = object.firstSession.startTimestamp.minuteOfHour, (#m==0 ? 'ha' : 'h:mma')" timezone="courseClass.timeZone" valueWhenEmpty="TBA"/>
             				 &ndash; 
             				 <span t:type="ui/willowtext" escapingHTML="false" value="courseClass.firstSession.endTimestamp" dateformat="~#m = object.firstSession.endTimestamp.minuteOfHour, (#m==0 ? 'ha' : 'h:mma')" timezone="courseClass.timeZone" valueWhenEmpty="TBA"/>
            			</span>
            			<t:if t:test="courseClass.hasManySessions">
            				<span class="class_session_exp">(<t:if test="courseClass.sessionsHaveDifferentTimes">first session<p:else>all sessions</p:else></t:if>)</span>
            			</t:if>
         			</a>
				</li>
				<t:if t:test="courseClass.hasManySessions">
					<li class="class_session">
            			<a class="timeline" rel="session" href="/Timeline/sessions?ids=${courseClass.id}" timezone="10">
             				 ${courseClass.sessions.size()} sessions, 
              				 <t:output value="courseClass.totalDurationHours" format="hoursFormat"/> hours total </a>
          			</li>
				</t:if>
				<p:else>
					<li class="class_date"><span t:type="ui/DateRangeDisplay" date1="courseClass.startDate" date2="courseClass.endDate" timezone="courseClass.classTimeZone" /></li>
			        <li class="class_time">
			          <span style="text-transform: lowercase;">
			            <span t:type="ui/willowText" escapeHTML="false" value="courseClass.startDate" dateformat="~#m = object.startDate.minuteOfHour, (#m==0 ? 'ha' : 'h:mma')" timezone="courseClass.timeZone" valueWhenEmpty="TBA" />
			            &ndash; 
			            <span t:type="ui/willowText" escapeHTML="false" value="courseClass.endDate" dateformat="~#m = object.endDate.minuteOfHour, (#m==0 ? 'ha' : 'h:mma')" timezone="courseClass.timeZone" valueWhenEmpty="TBA" />
			          </span>
			        </li>
				</p:else>
			</t:if>
		</ul>
		<ul class="class_locationtutor">
	      <li class="class_location">
	      	<t:if test="hasLinkToLocation">
	      		<t:if test="hasSiteSuburb">
	      			<dd>TBA</dd>
	      			<p:else>
	      				<a href="#" onclick="javascript:showSiteOnMap('${courseClass.room.site.id}')" title="Show venue on map" class="tooltip">${courseClass.room.site.suburb}</a>
	      			</p:else>
	      		</t:if>
	      		<p:else>
	      			 <t:if test="hasSite"><span t:type="roomLocation" room="courseClass.room" withRoomName="false" disabledLink="false" /><p:else>TBA</p:else></t:if>
	      		</p:else>
	      	</t:if>
	      </li>
	      <t:if test="hasTutorRoles">
	      	<li class="class_tutor">
	      		<t:loop source="courseClass.tutorRoles" value="tutorRole" index="index">
	      			<a class="tutorlink tooltip nyromodal tutorlink ${index}" href="/Refresh/tutor?x=Detail&amp;id1=${tutorRole.tutor.id}&amp;z=z&amp;wrap=false" title="View tutor profile">${tutorRole.tutor.fullName}</a>
	      		</t:loop>
        	</li>
	      </t:if>
      	  <t:if test="excludePrice">
      	  	<p:else>
      	  		<li><span t:type="CourseClassPrice" courseClass="courseClass" /></li>
      	  	</p:else>
         </t:if>
    </ul>
    <t:body />
    <t:if test="tutorPortal">
      <span t:type="CourseClassShortlistControl" courseClass="courseClass" />
    </t:if>
    <t:if test="courseClass.detail">
      <div class="detail_for_class" id="detail_for_class_${courseClass.id}" style="clear:both;">
        <p class="class_detail"><t:outputraw value="courseClass.detail"/></p>
      </div>
    </t:if>
    <t:if test="${courseClass.cancelled}" negate="true">
      <div class="bubbleInfo">
        <div class="tooltip_popup enrol_tooltip">
          <div class="bubble_top bubble_content clearfix"><span t:type="ClassTimingDisplay" courseClass="courseClass" /></div>
          <div class="bubble_middle bubble_content clearfix">
            <t:if test="courseClass.availableEnrolmentPlaces">
              <span t:type="CourseClassPlacesAvailable" courseClass="courseClass" />
              <t:if test="hasSiteName"> at ${courseClass.room.site.name}.</t:if>
              <p:else>
              	<span t:type="WaitingListItem" courseClass="courseClass" course="courseClass.course"/> 
            	<br style="clear:left;"/>
              </p:else>
            </t:if>
            <div class="class-link">
              <a href="">Print this class...</a>
            </div>
            <div class="course-link">
              <a href="">More about 
                <em>${courseClass.course.name}</em>...</a>
            </div>
          </div>
          <div class="bubble_bottom clearfix">&nbsp;</div>
          <br style="clear:both;" />
        </div>
      </div>
      <!-- sessions for all classes, displayed for tutor portal, hidden otherwise -->
      <t:if test="courseClass.hasAnyTimelineableSessions">
        <div id="sessions_for_class_${courseClass.id}" class="~'sessions_for_class${sessionForClass}"> 
        	<span t:type="TimetableEvents" displayedObjects="courseClass.timelineableSessions.@sort.room.site.name,startTimestamp"
        	 headerLabels="When,Time,Where" cssTableClass="session-table" cssEvenRowClass="tr-even" cssOddRowClass="tr-odd" 
        	 dateFormat="EEE dd MMM yyyy" timeFormat="hh:mma" /> </div>
      </t:if>
    </t:if>		
</div>
</t:container>