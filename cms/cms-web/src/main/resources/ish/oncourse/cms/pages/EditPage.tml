<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html t:type="ui/pagewrapper" title="${title}" bodyId="${bodyId}" bodyClass="${bodyClass}" xmlns:t="http://tapestry.apache.org/schema/tapestry_5_1_0.xsd" xmlns:p="tapestry:parameter">
	
	<t:block id="regionBlock">
		<div class="edit_region_link"><span t:type="actionLink" t:id="editRegion" t:zone="editorZone" context="region.regionKey">Edit this region</span></div>
		<t:outputraw value="regionContent" />
	</t:block>
	
	
	<div id="${templateId}">
		<t:zone t:id="contentZone" style="border: 1px dashed #eee;" class="region">
			<div t:id="webNodeTemplate" t:type="ui/webnodetemplate" node="node" blockSource="blockSource"></div>
		</t:zone>
	</div>
	
	<t:zone t:id="editorZone" visible="false"></t:zone>

	<t:block id="editorBlock">
		<div id="dialog" title="Basic dialog">
			<form t:id="regionForm" zone="contentZone">
				<textarea t:type="TextArea" value="editorRegion.content" rows="18" style="width: 99%"/>
			</form>
		</div>
		<script type="text/javascript">
					jQuery(function() {
						jQuery("#dialog").dialog({modal:true, height: 430, width: 530, 
							buttons: { 
								Cancel: function() {
									jQuery(this).dialog( "close" );
								}, 
								"Save Changes": function() { 
									jQuery(this).dialog( "close" );
									$('${regionForm.clientId}').fire(Tapestry.FORM_PROCESS_SUBMIT_EVENT);
								}
							}	
						});
					});
		</script>
	</t:block>
</html>
