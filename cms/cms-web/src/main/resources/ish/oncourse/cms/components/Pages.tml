<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<div xmlns:t="http://tapestry.apache.org/schema/tapestry_5_1_0.xsd"
	xmlns:p="tapestry:parameter" lang="en">
	
	<a t:id="newPage" t:type="actionLink" class="button">New Page</a> <input id="pageFilter" type="text" value=""/>
	
	<h2>Pages</h2>
	
	<table id="pages">
		<t:loop source="webNodeService.nodes" value="webNode">
			<tr id="${webNode.nodeNumber}">
				<td class="pageName">${webNode.name}</td>
				<td><t:if t:test="webNode.published">published<p:else>unpublished</p:else></t:if></td>
				<td><t:outputraw value="lastEdited"/></td>
			</tr>
		</t:loop>
	</table>
	
	<style>
		.selectedRow {
			background-color: yellow;
			cursor: pointer;
		 }
	</style>
	
	<script type="text/javascript">
		jQuery(function() {
			jQuery('#pageFilter').search('#pages tr', function(on) {
	            on.all(function(results) {
	             
	            });

	            on.reset(function() {
	              jQuery('#pages tr').show();
	            });

	            on.empty(function() {
	              jQuery('#pages tr').hide();
	            });

	            on.results(function(results) {
	              jQuery('#pages tr').hide();
	              results.show();
	            });
	          });
			
			jQuery('#pages tbody tr').mouseover(
					function() {
						jQuery(this).addClass('selectedRow');
					}).mouseout(
					function() {
			    		jQuery(this).removeClass('selectedRow');
			    	}).click(
			    	function() {
			    		window.location = '/page/' + jQuery(this).attr('id');
		           });
			
		});
	</script>
</div>