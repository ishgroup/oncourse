<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<t:container xmlns:t="http://tapestry.apache.org/schema/tapestry_5_1_0.xsd"
	xmlns:p="tapestry:parameter" lang="en" >
	
    <div class="cms-main-head">
        <div class="cms-main-title">
        	<h1 class="cms-page-title">Pages</h1>
        </div>
        <div class="cms-main-controls">
        	<span class="cms-ico-plus"></span>
            <a t:id="newPage" t:type="actionLink" class="button">Add new page</a>
       	</div>
        <div class="cms-search-block">
            <input id="pageFilter" maxlength="300" class="cms-field-wide cms-field-search" type="text" value=""/>
            <!-- button type="button" class="cms-btn-select"/>
            <button class="cms-btn-search" type="button"></button-->
        </div>
    </div>

	<t:zone t:id="pagesListZone">
    
    	<div class="cms-content cms-page-blocks"  >
				
    		<table class="cms-cont-table" id="pagestable">
    			<t:loop source="nodes" value="webNode">
					<tr>
						<td class="cms-first">${webNode.name}</td>
						<td class="cms-block-last-upd">page/${webNode.nodeNumber}</td>
						<td>
							<t:if t:test="webNode.published">
								<span data-pub="publish">
                	           		Published
	                 	       </span>
    	             	       <p:else>
									<span data-pub="hidden">
            	     	               Unpublished
                	 	           </span>
								</p:else>
							</t:if>
						</td>
						<td class="cms-block-last-upd"><t:outputraw value="lastEdited"/></td>
						<td>
							<span class="cms-ico-edit"></span> 
							<a href="${webNode.path}">Edit</a>
						</td>
                		<td class="cms-last">
                			<span class="cms-ico-del"></span> 
                			<t:actionLink t:id="deletePage" context="${webNode.nodeNumber}" zone="pagesListZone">Delete</t:actionLink>
                		</td>
					</tr>
				</t:loop>
	        </table>

    	</div>
    	
	</t:zone>
	
	<script type="text/javascript">
		jQuery(function() {
			jQuery('#pageFilter').search('#pagestable tr', function(on) {
	            on.all(function(results) {
	             
	            });

	            on.reset(function() {
	              jQuery('#pagestable tr').show();
	            });

	            on.empty(function() {
	              jQuery('#pagestable tr').hide();
	            });

	            on.results(function(results) {
	              jQuery('#pagestable tr').hide();
	              results.show();
	            });
	          });
			
		});
	</script>
	
</t:container>