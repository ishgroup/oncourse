<?xml version="1.0" encoding="UTF-8" ?>
<config>

	<lib dir="../../contrib/extraction/lib" />
	<lib dir="../../dist/" regex="apache-solr-cell-\d.*\.jar" />
	<lib dir="../../dist/" regex="apache-solr-clustering-\d.*\.jar" />
	<lib dir="../../contrib/clustering/lib/downloads/" />
	<lib dir="../../contrib/clustering/lib/" />
	<lib dir="/total/crap/dir/ignored" />
	
	<indexDefaults>
		<useCompoundFile>false</useCompoundFile>
		<mergeFactor>10</mergeFactor>
		<ramBufferSizeMB>32</ramBufferSizeMB>
		<maxFieldLength>10000</maxFieldLength>
		<writeLockTimeout>1000</writeLockTimeout>
		<commitLockTimeout>10000</commitLockTimeout>
		<lockType>native</lockType>
	</indexDefaults>

	<mainIndex>
		<useCompoundFile>false</useCompoundFile>
		<ramBufferSizeMB>32</ramBufferSizeMB>
		<mergeFactor>10</mergeFactor>
		<unlockOnStartup>false</unlockOnStartup>
		<reopenReaders>true</reopenReaders>
		<deletionPolicy class="solr.SolrDeletionPolicy">
			<str name="maxCommitsToKeep">1</str>
			<str name="maxOptimizedCommitsToKeep">0</str>
		</deletionPolicy>
		<infoStream file="INFOSTREAM.txt">false</infoStream>
	</mainIndex>

	<jmx />

	<updateHandler class="solr.DirectUpdateHandler2" />


	<query>
		<maxBooleanClauses>1024</maxBooleanClauses>
		<filterCache class="solr.FastLRUCache" size="512"
			initialSize="512" autowarmCount="0" />
		<queryResultCache class="solr.LRUCache" size="512"
			initialSize="512" autowarmCount="0" />
		<documentCache class="solr.LRUCache" size="512"
			initialSize="512" autowarmCount="0" />

		<enableLazyFieldLoading>true</enableLazyFieldLoading>
		<queryResultWindowSize>20</queryResultWindowSize>

		<queryResultMaxDocsCached>200</queryResultMaxDocsCached>

		<listener event="newSearcher" class="solr.QuerySenderListener">
			<arr name="queries">
			</arr>
		</listener>

		<listener event="firstSearcher" class="solr.QuerySenderListener">
			<arr name="queries">
				<lst>
					<str name="q">solr rocks</str>
					<str name="start">0</str>
					<str name="rows">10</str>
				</lst>
				<lst>
					<str name="q">static firstSearcher warming query from
						solrconfig.xml</str>
				</lst>
			</arr>
		</listener>

		<useColdSearcher>false</useColdSearcher>
		<maxWarmingSearchers>2</maxWarmingSearchers>
	</query>

	<requestDispatcher handleSelect="true">
		<requestParsers enableRemoteStreaming="true"
			multipartUploadLimitInKB="2048000" />
		<httpCaching lastModifiedFrom="openTime" etagSeed="Solr">
		</httpCaching>
	</requestDispatcher>

	<requestHandler name="standard" class="solr.SearchHandler" default="true">
		<lst name="defaults">
			<str name="echoParams">explicit</str>
			<int name="rows">10</int>
			<str name="version">2.1</str>
		</lst>
	</requestHandler>

	<requestHandler name="dismax" class="solr.SearchHandler">
		<lst name="defaults">
			<str name="defType">dismax</str>
			<str name="echoParams">explicit</str>
			<float name="tie">0.01</float>
			<str name="qf">name^10 course_code^10 class_code^10 suburb^5 postcode^5 course_tutor^5 dayName^5 dayType^5 detail^1</str>
			<str name="pf">name^10 course_code^10 class_code^10 suburb^5 postcode^5 course_tutor^5 dayName^5 dayType^5 detail^1</str>
			<str name="bf"></str>
			<str name="fl">name course_code class_code suburb postcode course_tutor dayName dayType detail</str>
			<str name="mm">2&lt;-25% 9&lt;-3</str>
			<int name="ps">100</int>
			<str name="q.alt">*:*</str>
			<!-- example highlighter config, enable per-query with hl=true -->
			<str name="hl.fl">text features name</str>
			<!-- for this field, we want no fragmenting, just highlighting -->
			<str name="f.name.hl.fragsize">0</str>
			<str name="f.name.hl.alternateField">name</str>
			<str name="f.text.hl.fragmenter">regex</str> <!-- defined below -->
		</lst>
	</requestHandler>


	<searchComponent name="spellcheck" class="solr.SpellCheckComponent">
		<str name="queryAnalyzerFieldType">textSpell</str>

		<lst name="spellchecker">
			<str name="name">default</str>
			<str name="field">name</str>
			<str name="spellcheckIndexDir">./spellchecker</str>
		</lst>
	</searchComponent>

	<requestHandler name="/spell" class="solr.SearchHandler"
		lazy="true">
		<lst name="defaults">
			<!-- omp = Only More Popular -->
			<str name="spellcheck.onlyMorePopular">false</str>
			<!-- exr = Extended Results -->
			<str name="spellcheck.extendedResults">false</str>
			<!-- The number of suggestions to return -->
			<str name="spellcheck.count">1</str>
		</lst>
		<arr name="last-components">
			<str>spellcheck</str>
		</arr>
	</requestHandler>

	<searchComponent name="tvComponent"
		class="org.apache.solr.handler.component.TermVectorComponent" />
	<requestHandler name="tvrh"
		class="org.apache.solr.handler.component.SearchHandler">
		<lst name="defaults">
			<bool name="tv">true</bool>
		</lst>
		<arr name="last-components">
			<str>tvComponent</str>
		</arr>
	</requestHandler>

	<searchComponent name="clusteringComponent"
		enable="${solr.clustering.enabled:false}" class="org.apache.solr.handler.clustering.ClusteringComponent">
		<!-- Declare an engine -->
		<lst name="engine">
			<str name="name">default</str>
			<str name="carrot.algorithm">org.carrot2.clustering.lingo.LingoClusteringAlgorithm
			</str>
			<str name="LingoClusteringAlgorithm.desiredClusterCountBase">20</str>
		</lst>
		<lst name="engine">
			<str name="name">stc</str>
			<str name="carrot.algorithm">org.carrot2.clustering.stc.STCClusteringAlgorithm</str>
		</lst>
	</searchComponent>

	<!-- Solr Cell: http://wiki.apache.org/solr/ExtractingRequestHandler -->
	<requestHandler name="/update/extract"
		class="org.apache.solr.handler.extraction.ExtractingRequestHandler"
		startup="lazy">
		<lst name="defaults">
			<str name="fmap.content">text</str>
			<str name="lowernames">true</str>
			<str name="uprefix">ignored_</str>
			<str name="captureAttr">true</str>
			<str name="fmap.a">links</str>
			<str name="fmap.div">ignored_</str>
		</lst>
	</requestHandler>

	<searchComponent name="termsComponent"
		class="org.apache.solr.handler.component.TermsComponent" />

	<requestHandler name="/terms"
		class="org.apache.solr.handler.component.SearchHandler">
		<lst name="defaults">
			<bool name="terms">true</bool>
		</lst>
		<arr name="components">
			<str>termsComponent</str>
		</arr>
	</requestHandler>

	<searchComponent name="elevator" class="solr.QueryElevationComponent">
		<!-- pick a fieldType to analyze queries -->
		<str name="queryFieldType">string</str>
		<str name="config-file">elevate.xml</str>
	</searchComponent>

	<requestHandler name="/elevate" class="solr.SearchHandler"
		startup="lazy">
		<lst name="defaults">
			<str name="echoParams">explicit</str>
		</lst>
		<arr name="last-components">
			<str>elevator</str>
		</arr>
	</requestHandler>

	<requestHandler name="/update" class="solr.XmlUpdateRequestHandler" />
	<requestHandler name="/update/javabin" class="solr.BinaryUpdateRequestHandler" />
	<requestHandler name="/analysis/document"
		class="solr.DocumentAnalysisRequestHandler" />
	<requestHandler name="/analysis/field" class="solr.FieldAnalysisRequestHandler" />
	<requestHandler name="/update/csv" class="solr.CSVRequestHandler"
		startup="lazy" />
	<requestHandler name="/admin/"
		class="org.apache.solr.handler.admin.AdminHandlers" />

	<requestHandler name="/admin/ping" class="PingRequestHandler">
		<lst name="defaults">
			<str name="qt">standard</str>
			<str name="q">solrpingquery</str>
			<str name="echoParams">all</str>
		</lst>
	</requestHandler>

	<requestHandler name="/debug/dump" class="solr.DumpRequestHandler">
		<lst name="defaults">
			<str name="echoParams">explicit</str>
			<str name="echoHandler">true</str>
		</lst>
	</requestHandler>

	<requestHandler name="/dataimport"
		class="org.apache.solr.handler.dataimport.DataImportHandler">
		<lst name="defaults">
			<str name="config">oncourse-jdbc.xml</str>
		</lst>
	</requestHandler>

	<highlighting>
		<fragmenter name="gap" class="org.apache.solr.highlight.GapFragmenter"
			default="true">
			<lst name="defaults">
				<int name="hl.fragsize">100</int>
			</lst>
		</fragmenter>

		<fragmenter name="regex"
			class="org.apache.solr.highlight.RegexFragmenter">
			<lst name="defaults">
				<int name="hl.fragsize">70</int>
				<float name="hl.regex.slop">0.5</float>
				<str name="hl.regex.pattern">[-\w ,/\n\"']{20,200}</str>
			</lst>
		</fragmenter>

		<formatter name="html" class="org.apache.solr.highlight.HtmlFormatter"
			default="true">
			<lst name="defaults">
				<str name="hl.simple.pre"><![CDATA[<em>]]></str>
				<str name="hl.simple.post"><![CDATA[</em>]]></str>
			</lst>
		</formatter>
	</highlighting>

	<queryResponseWriter name="xslt"
		class="org.apache.solr.request.XSLTResponseWriter">
		<int name="xsltCacheLifetimeSeconds">5</int>
	</queryResponseWriter>
	  
	<queryParser name="sfilt" class="org.apache.solr.search.SpatialFilterQParserPlugin" />
	
	<admin>
		<defaultQuery>solr</defaultQuery>
	</admin>
</config>
