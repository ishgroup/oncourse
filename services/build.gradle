apply plugin: 'war'

dependencies {
	providedCompile 'javax.servlet:servlet-api:2.5'

	compile project(':common:common-model')
	compile project(':common:common-services')

	compile ('ish.oncourse.willow:webservices-client:5.1.10')
	{
		//we should exclude cayenne-server from waCommon because the cayenne-server is not compatable to willow code.
		exclude group: 'org.apache.cayenne', module: 'cayenne-server'
	}
    //we cannot use version greater the 2.6.1 because task #15873
	compile ('org.apache.cxf:cxf-bundle:2.6.1') {
		exclude group: 'org.apache.geronimo.specs', module: 'geronimo-servlet_3.0_spec'
		exclude group: 'org.apache.geronimo.specs', module: 'geronimo-javamail_1.4_spec'
	}
	compile 'org.apache.tapestry:tapestry-spring:5.2.6'
	compile 'org.apache.tapestry:tapestry-ioc:5.2.6'
	compile 'org.springframework:spring-core:3.0.5.RELEASE'
	compile 'org.springframework:spring-beans:3.0.5.RELEASE'
	compile 'org.springframework:spring-context:3.0.5.RELEASE'
	compile 'org.springframework:spring-web:3.0.5.RELEASE'
	compile 'aopalliance:aopalliance:1.0'
	compile 'commons-logging:commons-logging:1.1.1'
	compile 'com.google.inject:guice:3.0'

    //we should use these dependences for test because TestServer is not started properly otherwise.
    testCompile 'org.eclipse.jetty:jetty-util:7.4.2.v20110526'
    testCompile 'org.eclipse.jetty:jetty-server:7.4.2.v20110526'
    testCompile 'org.eclipse.jetty:jetty-webapp:7.4.2.v20110526'
    testCompile 'org.eclipse.jetty:jetty-plus:7.4.2.v20110526'
    testCompile 'org.eclipse.jetty:jetty-jndi:7.4.2.v20110526'
    testCompile 'org.eclipse.jetty:jetty-io:7.4.2.v20110526'
    testCompile 'org.eclipse.jetty:jetty-security:7.4.2.v20110526'
    testCompile 'wsdl4j:wsdl4j:1.6.2'

	// The odd next line is to work around gradle pulling in the wrong configuration
	// http://forums.gradle.org/gradle/topics/transitive_libraries_not_included_through_project_dependency
	testCompile project(path: ':common:common-test', configuration: 'testFixtures')
}

war {
	archiveName = 'services.war'
	manifest {
		from sharedManifest
	}
}