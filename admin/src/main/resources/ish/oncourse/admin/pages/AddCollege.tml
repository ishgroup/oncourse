<html t:type="pagestructure" title="literal:Add College"
	xmlns:t="http://tapestry.apache.org/schema/tapestry_5_1_0.xsd" xmlns:p="tapestry:parameter">
	
		<table>
			<tr>
				<td>Services Key</td>
				<td><input id="serviceKey" type="text"/></td>
			</tr>
			<tr>
				<td><button id="find">Find</button></td>
			</tr>
		</table>
	
	<div id="results">
	</div>
	
	<div id="newCollege">
		<t:form t:id="newCollegeForm">
			<input id="collegeId" t:type="hidden" property="collegeId" value="collegeId"/>
			<table>
				<tr>
					<td>Billing Code</td>
					<td><t:textfield t:id="billingCode" value="billingCode"/></td>
				</tr>
				<tr>
					<td>Web Services Password</td>
					<td><t:textfield t:id="servicesPass" value="servicesPassword"/></td>
				</tr>
			</table>
			<t:submit t:id="addNewCollege" value="Next"/>
		</t:form>
	</div>
	
	<script type="text/javascript">
		jQuery(function() {
			jQuery("#newCollege").hide();
			
			jQuery("#find").click(function() {
				jQuery("#newCollege").hide();
				
				var key = jQuery("#serviceKey").attr("value");
				
				var success = function(data) {
					jQuery("#results").empty();
					jQuery("#results").append(data["message"]);
					
					if (data["status"] == "SETUP") {
						jQuery("#collegeId").val(data["id"]);
						jQuery("#newCollege").show();
					}
				}
				
				jQuery.ajax({
					url: "${findCollegeUrl}",
					data: "key=" + key,
					success: success,
					dataType: "json"
				});
			});
		});
	</script>
</html>