<html t:type="pagestructure" title="literal:College Billing"
	  xmlns:t="http://tapestry.apache.org/schema/tapestry_5_1_0.xsd"
		>

<span t:type="editTabs" college="college" selected="literal:billing" />

<h1>${college.name}</h1>

<t:form t:id="billingForm">
	<table class="table table-striped table-condensed">
		<tr>
			<td>College name</td>
			<td><t:textfield t:id="collegeName" value="collegeName" /></td>
		</tr>
		<tr>
			<td>PaymentExpress user</td>
			<td><t:textfield t:id="paymentUser" value="paymentExpUser" />
			</td>
		</tr>
		<tr>
			<td>PaymentExpress password</td>
			<td><t:textfield t:id="paymentPass" value="paymentExpPass" />
			</td>
		</tr>
		<tr>
			<td>Billing code</td>
			<td><t:textfield t:id="billingCode" value="billingCode" validate="required"/></td>
		</tr>
	</table>

	<label class="checkbox">
		<t:checkbox t:id="replicationCheckbox" value="replicationEnabled"/>Replication enabled
	</label>
	<t:if test="showReplicationMessage">
		<div class="message">
			Restart this angel server two times:
			<ul>
				<li>for loading preferences to angel side.</li>
				<li>for rescheduling replication job.</li>
			</ul>
		</div>
	</t:if>

	<label class="checkbox">
		<t:checkbox t:id="webPaymentCheckbox" value="webPaymentEnabled"/>web payment gateway enabled
	</label>
	<label class="checkbox">
		<t:checkbox t:id="qePaymentCheckbox" value="qePaymentEnabled"/>onCourse QuickEnrol payments enabled
	</label>
	<label class="checkbox">
		<t:checkbox t:id="amexCheckbox" value="amexEnabled"/>Amex card type enabled
	</label>

	<h2>License Fees (onCourse)</h2>

	<table class="table table-striped table-condensed">
		<thead>
		<tr>
			<td>Key Code</td>
			<td>Plan Name</td>
			<td>Paid Until</td>
			<td>Renewal Date</td>
			<td>Free Transactions</td>
			<td>Fee</td>
		</tr>
		</thead>
		<tbody>
		<t:loop source="collegeLicenseFees" index="feeIndex">
			<tr>
				<td>${currentCollegeLicenseFee.keyCode}</td>
				<td><t:textfield t:id="collegePlanName" value="currentCollegePlanName"/></td>
				<td>
					<t:if test="support">
						<t:textfield t:id="collegePaidUntil" class="datefield" value="currentCollegeFeePaidUntil"/>
					</t:if>
				</td>
				<td>
					<t:if test="support">
						<t:textfield t:id="collegeRenewalDate" class="datefield" value="currentCollegeFeeRenewalDate"/>
					</t:if>
				</td>
				<td><t:textfield t:id="collegeFreeTransactions" t:validate="required" value="currentCollegeLicenseFee.freeTransactions"/></td>
				<td><t:textfield t:id="collegeFee" t:validate="required" value="currentCollegeLicenseFee.fee"/></td>
			</tr>
		</t:loop>
		</tbody>
	</table>

	<t:loop source="webSites" index="webSiteIndex">
		<h2>License Fees (${currentWebsite.name})</h2>
		<table class="table table-striped table-condensed">
			<thead>
			<tr>
				<td>Key Code</td>
				<td>Plan Name</td>
				<td>Paid Until</td>
				<td>Renewal Date</td>
				<td>Free Transactions</td>
				<td>Fee</td>
			</tr>
			</thead>
			<tbody>
			<t:loop source="currentWebsite.licenseFees" index="feeIndex">
				<tr>
					<td>${currentLicenseFee.keyCode}</td>
					<td><t:textfield t:id="planName" value="currentPlanName"/></td>
					<td>
						<t:if test="hosting">
							<t:textfield t:id="paidUntil" class="datefield" value="currentPaidUntil"/>
						</t:if>
					</td>
					<td>
						<t:if test="hosting">
							<t:textfield t:id="renewalDate" class="datefield" value="currentRenewalDate"/>
						</t:if>
					</td>
					<td><t:textfield t:id="freeTransactions" t:validate="required" value="currentLicenseFee.freeTransactions"/></td>
					<td><t:textfield t:id="fee" t:validate="required" value="currentLicenseFee.fee"/></td>
				</tr>
			</t:loop>
			</tbody>
		</table>
	</t:loop>

	<t:errors/>
	
	<div class="form-actions">
		<t:submit t:id="save" class="btn btn-primary" value="Save"/>
	</div>
</t:form>

	<script type="text/javascript">
		jQuery(function() {		
			jQuery( ".datefield" ).datepicker({ dateFormat: 'dd/mm/yy' });
			jQuery( ".datefield" ).datepicker({ dateFormat: 'dd/mm/yy' });
		});
	</script>

</html>