apply plugin: 'com.eriwen.gradle.js'
apply plugin: 'com.github.robfletcher.compass'

apply from: "$rootDir/gradle/buildTapestryApp.gradle"
ext {
    staticSrcPath = "src/main/static"
    staticBuildPath = "${buildDir}/resource-assemble/static"
}

mainClassName = 'ish.oncourse.portal.PortalApp'

dependencies {
    compile 'org.mnode.ical4j:ical4j:1.0.2'
    compile 'com.ocpsoft:ocpsoft-pretty-time:1.0.7'
    compile 'com.fasterxml.jackson.core:jackson-databind:2.7.5'
    compile (project(':common:common-textile')) {
        exclude group: 'axis', module: 'axis-wsdl4j'
        exclude group: 'org.apache.tapestry'
    }
    // The odd next line is to work around gradle pulling in the wrong configuration
    // http://forums.gradle.org/gradle/topics/transitive_libraries_not_included_through_project_dependency
    testCompile(project(path: ':common:common-test', configuration: 'testFixtures')) {
        exclude group: 'org.apache.tapestry'
    }
}

apply from: "build-static.gradle"

jar {
    from "${buildDir}/resource-assemble"
    from ('src/main') {
        include 'static/**/*'
        exclude 'static/js'
        exclude 'static/src'
    }
}
