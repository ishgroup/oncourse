dependencies {
    compile project(':common:waCommon')
    compile 'org.apache.cxf:cxf-bundle:2.6.16'
}

jar {
	manifest {
		from sharedManifest
	}
}


configurations {
    all*.exclude group: 'org.apache.logging.log4j', module: 'log4j-web'
    ws
}
 
dependencies{
    ws "org.apache.cxf:cxf-tools:2.6.16",
        "org.apache.cxf:cxf-tools-wsdlto-databinding-jaxb:2.6.16",
        "org.apache.cxf:cxf-tools-wsdlto-frontend-jaxws:2.6.16",
        "org.jvnet.jaxb2_commons:jaxb2-basics:0.6.5"
        "log4j:log4j:1.2.17"
}

project.ext {
    wsdlDir = file("${projectDir}/src/main/resources/wsdl")
    generatedWsdlDir = file("${projectDir}/src/main/java")
    wsdlsToGenerate = [
        ['-xjc', '-xjc-Xinheritance',
                 '-wsdlLocation', "/wsdl/v10_replication.wsdl",
                 '-p', 'ish.oncourse.webservices.v10.stubs.replication',
                 '-b', "$wsdlDir/replication10_binding.xml", 
                 "$wsdlDir/v10_replication.wsdl"],
    ]
}

task wsdl2Java() {
    inputs.files wsdlDir.listFiles()
    outputs.files generatedWsdlDir

    doLast {
        wsdlsToGenerate.each { argsin ->
            argsin.add(argsin.size - 1, '-d')
            argsin.add(argsin.size - 1, generatedWsdlDir)
            javaexec {
                classpath configurations.ws
                main = 'org.apache.cxf.tools.wsdlto.WSDLToJava'
                args = argsin
                systemProperties = ['exitOnFinish':'TRUE']
            }
        }
    }
}

