sourceSets.main.java.srcDirs = []
sourceSets.main.groovy.srcDir 'src/main/java'

configurations {
    all*.exclude group: 'org.apache.logging.log4j', module: 'log4j-web'
}

dependencies {
	compile "org.apache.cayenne:cayenne-server:$cayenneVersion"
    compile 'org.apache.commons:commons-lang3:3.3.2'
    compile 'commons-codec:commons-codec:1.10'
	compile "org.codehaus.groovy:groovy-all:$groovyVersion"
    compile 'javax.mail:mail:1.4.7'
	compile 'org.springframework:spring-context:4.2.4.RELEASE'
}



task sourceJar(type: Jar, dependsOn: classes) {
    classifier = 'sources'
    from sourceSets.main.allSource
}

def sourceArtifact = artifacts.add('archives', file("${buildDir}/libs/waCommon-" + version + "-sources.jar")) {
    builtBy sourceJar
}

def jarArtifact = artifacts.add('archives', file("${buildDir}/libs/waCommon-" + version + ".jar")) {
    builtBy sourceJar
}
publishing {
    publications {
        source(MavenPublication) {
            artifact(sourceArtifact)
        }

        jar(MavenPublication) {
            artifact(jarArtifact)
        }
    }
}
