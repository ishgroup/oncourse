plugins {
    id 'java-library'
}

apply from: "$rootDir/gradle/functions.gradle"

sourceSets.main.java.srcDirs = []
sourceSets.main.groovy.srcDir 'src/main/java'

sourceSets.test.java.srcDirs = []
sourceSets.test.groovy.srcDir 'src/test/java'

//groovy compile should read source files in UTF-8
//because some tests (ish.oncourse.services.textile.TextileUtilTest.test_unicodeQuotesEncoding)
//use UTF-8 chars
compileGroovy.options.encoding = 'UTF-8'
compileTestGroovy.options.encoding = 'UTF-8'

dependencies {
    api project(':common:cayenne-model')
    api 'javax.cache:cache-api:1.0.0'
    api "org.ehcache:ehcache:$ehcacheVersion"
    api 'javax.servlet:servlet-api:3.0'
    api 'axis:axis:1.4'
    api 'wsdl4j:wsdl4j:1.6.3'
    api "org.apache.solr:solr-solrj:$solrVersion"
    api 'commons-httpclient:commons-httpclient:3.1'
    api 'net.java.dev.textile-j:textile-j:2.2.864'
    api 'org.commonmark:commonmark:0.18.1'
    api 'org.commonmark:commonmark-ext-gfm-tables:0.18.1'
    api 'org.commonmark:commonmark-ext-heading-anchor:0.18.1'

    api "com.github.ben-manes.caffeine:caffeine:$caffeineVersion"
    api "com.github.ben-manes.caffeine:jcache:$caffeineVersion"

    testImplementation project(':common:test-functions')
}

test {
    forkEvery = 1 //run every test in separate jvm
    initTestDBConfig(project, test)
}
